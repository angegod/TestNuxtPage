import{_ as ue,r as k,c as o,o as s,b as G,w as Y,f,u as n,a as e,t as g,F as h,n as y,g as H,E as X,T as ve,G as xe,k as ge,j as de,i as we,H as be,q as he,v as ye}from"./CBWoeo8S.js";import{a as T}from"./Dq7h7Pqt.js";import _e from"./Dk3xIEeS.js";import ke from"./DXuBvx1p.js";import{N as $e,P as Ee,S as re,C as ce}from"./BzubXTEs.js";const Ce={class:"h-[500px] pl-5"},Ie={class:"flex flex-row min-w-[500px]",key:"step1"},Be={class:"pl-2 pr-2 w-1/2"},Se={class:"flex flex-col"},Ne={class:"mt-3 flex flex-row items-baseline"},je={class:"flex flex-col mt-5"},De=["value"],Pe={class:"flex flex-col mt-5"},Fe=["src"],Le={class:"pl-2 pr-2 w-1/2 flex flex-col justify-between"},Te={class:"flex flex-col"},Ke=["src"],Oe={key:"step2",class:"flex flex-row min-w-[500px]"},Je={class:"w-1/2 pl-2 pr-2 flex flex-col"},Me={class:"flex flex-col mt-5"},Ue={class:"flex flex-row mb-1"},Ve=["onUpdate:modelValue"],Ae={class:"flex flex-col mt-5"},qe={class:"flex flex-row mb-1"},Ge=["placeholder","onUpdate:modelValue"],Re={class:"flex flex-col mt-5"},He={class:"flex flex-row mb-1"},ze=["placeholder","onUpdate:modelValue"],Qe={class:"w-1/2 pl-2 pr-2 flex flex-col justify-between min-h-[400px]"},We={class:"flex flex-col"},Xe={class:"colorSelect w-[150px]",id:"tagSelect2"},Ye=["label"],Ze=["value"],et={class:"flex flex-col"},tt={class:"flex flex-row min-w-[500px]",key:"step3"},lt={class:"px-2 w-1/2 [&>div]:my-2"},nt={class:"flex flex-row"},st={class:"flex flex-row"},at={class:"flex flex-row"},ot={class:"flex flex-row"},it={class:"w-1/2"},dt={class:"flex flex-col"},ut={class:"my-2"},rt={class:"spread"},ct=["src"],ft={class:"min-w-[500px]",key:"step4"},pt={class:"w-5/6 mx-auto mt-5 flex flex-row flex-wrap justify-between mb-5 max-[450px]:justify-center"},mt={class:"w-2/5 min-w-[150px] max-[450px]:w-[100%]"},vt={class:"[&>span]:text-[20px] mb-3 text-center"},xt={key:0,class:"w-[100%] text-center text-amber-900 font-bold"},gt={key:1,class:"w-[100%] text-center text-slate-500 font-bold"},wt={key:2,class:"w-[100%] text-center text-yellow-600 font-bold"},bt={key:0,class:"imgbox1 max-w-[150px] mx-auto"},ht=["src","alt"],yt={key:1,class:"imgbox2 max-w-[150px] mx-auto"},_t=["src","alt"],kt={key:2,class:"imgbox3 max-w-[150px] mx-auto"},$t=["src","alt"],Et={class:"w-1/2 flex flex-col min-w-[150px] ml-2 max-[450px]:ml-0 max-[450px]:w-[100%]"},Ct={class:"flex flex-col mt-5 min-h-[10vh]"},It={class:"flex flex-row line"},Bt={key:0,class:"flex bg-amber-900 text-white rounded-md w-1/5 min-w-[100px] justify-center"},St={key:1,class:"flex bg-slate-500 text-white rounded-md w-1/5 min-w-[100px] justify-center"},Nt={key:2,class:"flex bg-yellow-600 text-white rounded-md w-1/5 min-w-[100px] justify-center"},jt={class:"flex flex-col"},Dt={class:"text-black"},Pt={class:"flex flex-col mt-5 min-h-[20vh]"},Ft={key:0,class:"flex bg-amber-900 text-white rounded-md w-1/5 min-w-[100px] justify-center"},Lt={key:1,class:"flex bg-slate-500 text-white rounded-md w-1/5 min-w-[100px] justify-center"},Tt={key:2,class:"flex bg-yellow-600 text-white rounded-md w-1/5 min-w-[100px] justify-center"},Kt={class:"flex flex-col"},Ot={class:"text-black"},Jt={class:"flex flex-col mt-5 min-h-[10vh]"},Mt={key:0,class:"flex bg-amber-900 text-white rounded-md w-1/5 min-w-[100px] justify-center"},Ut={key:1,class:"flex bg-slate-500 text-white rounded-md w-1/5 min-w-[100px] justify-center"},Vt={key:2,class:"flex bg-yellow-600 text-white rounded-md w-1/5 min-w-[100px] justify-center"},At={class:"flex flex-col"},qt={class:"text-black"},Gt={__name:"AddCard",props:["max","func"],emits:["close"],setup(L,{expose:N,emit:P}){let K=L,a=k({}),b=k(1),m=k(null),w=k(null),C=k(null),F=k([]),v=k([]),I=k([""]),E=k([""]),B=k([""]);const O=P;console.log(F.value);function J(p){document.getElementById(p).value=null,document.getElementById(p).click()}async function M(p){let l=document.getElementById(p).files[0];const i=new FileReader;i.onload=x=>{p==="iconInput"?m.value={file:x.target.result,name:l.name,realFile:l}:p==="imageInput"?w.value={file:x.target.result,name:l.name,realFile:l}:p==="spreadInput"&&(C.value={file:x.target.result,name:l.name,realFile:l}),console.log(C.value)},await i.readAsDataURL(l)}function V(p){switch(p){case"combo":E.value.push("");break;case"round":I.value.push("");break;case"instant":B.value.push("");break}}function A(p){switch(p){case"combo":E.value.length>1&&(E.value=E.value.filter((l,i)=>i!==E.value.length-1)),console.log(E.value.length);break;case"round":I.value.length>1&&(I.value=I.value.filter((l,i)=>i!==I.value.length-1)),console.log(I.value.length);break;case"instant":B.value.length>1&&(B.value=B.value.filter((l,i)=>i!==B.value.length-1)),console.log(B.value.length);break}}function z(){console.log(F.value);var p=parseInt(document.getElementById("tagSelect2").value),l={};F.value.forEach(i=>{let x=i.data.find(j=>j.id===p);x!==void 0&&(l=x)}),console.log(p),!(v.value.includes(l)||p===0)&&(v.value.push(l),console.log(v.value),v.value=v.value.sort((i,x)=>i.id-x.id),a.value.tag.push(p),a.value.tag=a.value.tag.sort((i,x)=>i-x),console.log(v.value))}function q(p){p.key==="Enter"&&(a.value.keyword===void 0&&(a.value.keyword=[]),a.value.keyword.push(p.target.value),p.target.value="",console.log(a.value.keyword))}async function U(){if(console.log(b.value),b.value<3){b.value+=1;return}if(b.value===3)if(a.value.PointMax===void 0||a.value.PointConsume===void 0||a.value.PointGet===void 0||a.value.PointEnter===void 0){alert("請輸入對應資料!!");return}else{Q(),b.value+=1;return}if(b.value===4){console.log("step4"),b.value+=1;let p=new FormData;p.append("image",m.value.realFile),p.append("oldName",m.value.name.split(".")[0]),p.append("newName",`1_${a.value.id}`),console.log(p.getAll("image"));const l=await T.post("http://localhost:5000/card/icon",p,{headers:{"Content-Type":"multipart/form-data"}});console.log(l.data);let i=new FormData;i.append("image",w.value.realFile),i.append("oldName",w.value.name.split(".")[0]),i.append("newName",`1_${a.value.id}`),console.log(w.value);const x=await T.post("http://localhost:5000/card/image",i,{headers:{"Content-Type":"multipart/form-data"}});if(console.log(x.data),console.log(C),C.value!==null&&C.value!==void 0){console.log("開始上傳盤面");let D=new FormData;D.append("image",C.value.realFile),D.append("oldName",C.value.name.split(".")[0]),D.append("newName",`1_${a.value.id}`),console.log(C.value),await T.post("http://localhost:5000/card/spread",D,{headers:{"Content-Type":"multipart/form-data"}})}let j={series:1,card:a.value};console.log(j),await T.post("http://localhost:5000/card/add",j).then(D=>{console.log(D.data),b.value=1,alert("新卡片已添加"),O("close",""),O("updateCard",D.data)})}}function Q(){a.value.id===void 0&&(a.value.id=K.max),a.value.roundEffect=I.value,a.value.instantEffect=B.value,a.value.comboEffect=E.value,a.value.image=`/images/card/icon/1_${a.value.id}.png`,a.value.fullimage=`/images/card/image/1_${a.value.id}.png`,document.getElementById("spreadIndex").value===null&&(a.value.spread={id:parseInt(document.getElementById("spreadIndex").value),image:`/images/card/image/${a.value.id}.png`});let p=[];v.value.forEach(i=>{p.push(parseInt(i.id))}),a.value.tag=p;let l={id:a.value.id,name:a.value.name,rarity:a.value.rarity,image:a.value.image,instantEffect:a.value.instantEffect,roundEffect:a.value.roundEffect,comboEffect:a.value.comboEffect,PointMax:parseInt(a.value.PointMax),PointEnter:parseInt(a.value.PointEnter),PointConsume:parseInt(a.value.PointConsume),PointGet:parseInt(a.value.PointGet),tag:a.value.tag,fullimage:a.value.fullimage,keyword:a.value.keyword,...a.value.spread?{spread:a.value.spread}:{}};a.value=l,console.log(a.value)}function W(p){F.value=p}return N({setFunc:W}),(p,l)=>(s(),o("div",Ce,[G(ve,{name:"step",tag:"div",class:"flex flex-row"},{default:Y(()=>[n(b)===1?(s(),o("div",Ie,[e("div",Be,[e("div",Se,[l[19]||(l[19]=e("span",{class:"text-lg"},"卡片名稱:",-1)),e("input",{type:"text",class:"selfInput",placeholder:"卡片名子",onChange:l[0]||(l[0]=i=>n(a).name=i.target.value)},null,32)]),e("div",Ne,[l[20]||(l[20]=e("span",{class:"text-lg mr-1"},"卡片編號:",-1)),e("span",null,g(L.max),1)]),e("div",je,[l[21]||(l[21]=e("span",{class:"text-lg"},"稀有度:",-1)),(s(),o(h,null,y(3,i=>e("div",null,[e("input",{type:"radio",name:"rarity",value:i,onChange:l[1]||(l[1]=x=>n(a).rarity=parseInt(x.target.value))},null,40,De),e("span",null,g(i+"星"),1)])),64))]),e("div",Pe,[l[22]||(l[22]=e("span",{class:"text-lg"},"縮圖:",-1)),e("button",{onClick:l[2]||(l[2]=i=>J("iconInput")),class:"max-w-[100px] addBtn"},"上傳"),e("input",{type:"file",id:"iconInput",class:"hidden",accept:"image/jpeg, image/png, image/jpg",onChange:l[3]||(l[3]=()=>M("iconInput"))},null,32),n(m)!==null?(s(),o("img",{key:0,src:n(m).file,alt:"縮圖",class:"max-w-[100px] max-h-[100px]"},null,8,Fe)):f("",!0)])]),e("div",Le,[e("div",Te,[l[23]||(l[23]=e("span",{class:"text-lg"},"全身圖:",-1)),e("button",{onClick:l[4]||(l[4]=i=>J("imageInput")),class:"max-w-[100px] addBtn"},"上傳"),e("input",{type:"file",id:"imageInput",class:"hidden",accept:"image/jpeg, image/png, image/jpg",onChange:l[5]||(l[5]=()=>M("imageInput"))},null,32),n(w)!==null?(s(),o("img",{key:0,src:n(w).file,alt:"縮圖",class:"max-w-[200px] max-h-[300px]"},null,8,Ke)):f("",!0)]),e("div",null,[e("button",{class:"addBtn pl-2 pr-2",onClick:U},"下一步")])])])):f("",!0),n(b)===2?(s(),o("div",Oe,[e("div",Je,[e("div",Me,[e("div",Ue,[l[24]||(l[24]=e("span",{class:"text-lg"},"即時效果:",-1)),e("button",{class:"addBtn ml-3 px-3",onClick:l[6]||(l[6]=i=>V("instant"))},"添加"),n(B).length>1?(s(),o("button",{key:0,class:"addBtn ml-3 px-3",onClick:l[7]||(l[7]=i=>A("instant"))},"刪除")):f("",!0)]),(s(!0),o(h,null,y(n(B),(i,x)=>H((s(),o("input",{type:"text",class:"selfInput mt-1 mb-1",placeholder:"即使效果","onUpdate:modelValue":j=>n(B)[x]=j},null,8,Ve)),[[X,n(B)[x]]])),256))]),e("div",Ae,[e("div",qe,[l[25]||(l[25]=e("span",{class:"text-lg"},"回合效果:",-1)),e("button",{class:"addBtn ml-3 px-3",onClick:l[8]||(l[8]=i=>V("round"))},"添加"),n(I).length>1?(s(),o("button",{key:0,class:"addBtn ml-3 px-3",onClick:l[9]||(l[9]=i=>A("round"))},"刪除")):f("",!0)]),(s(!0),o(h,null,y(n(I),(i,x)=>H((s(),o("input",{type:"text",class:"selfInput mt-1 mb-1 whitespace-pre-wrap",placeholder:`回合效果${x+1}`,"onUpdate:modelValue":j=>n(I)[x]=j},null,8,Ge)),[[X,n(I)[x]]])),256))]),e("div",Re,[e("div",He,[l[26]||(l[26]=e("span",{class:"text-lg"},"連動效果:",-1)),e("button",{class:"addBtn ml-3 px-3",onClick:l[10]||(l[10]=i=>V("combo"))},"添加"),n(E).length>1?(s(),o("button",{key:0,class:"addBtn ml-3 px-3",onClick:l[11]||(l[11]=i=>A("combo"))},"刪除")):f("",!0)]),(s(!0),o(h,null,y(n(E),(i,x)=>H((s(),o("textarea",{class:"selfInput mt-1 mb-1 min-h-[25px] max-h-[50px]",placeholder:`連動效果${x+1}`,"onUpdate:modelValue":j=>n(E)[x]=j},null,8,ze)),[[X,n(E)[x]]])),256))])]),e("div",Qe,[e("div",We,[l[28]||(l[28]=e("div",null,[e("span",null,"技能標籤")],-1)),e("div",null,[e("select",Xe,[l[27]||(l[27]=e("option",{value:0},g("請選擇"),-1)),(s(!0),o(h,null,y(n(F),i=>(s(),o("optgroup",{label:i.typeName},[(s(!0),o(h,null,y(i.data,x=>(s(),o("option",{value:x.id,class:"bg-amber-900"},g(x.name),9,Ze))),256))],8,Ye))),256))]),e("button",{class:"rounded-sm bg-gray-600 min-w-[50px] text-white",onClick:l[12]||(l[12]=i=>z())},"新增")]),e("div",et,[(s(!0),o(h,null,y(n(v),i=>(s(),o("span",null,g(i.id+" "+i.name),1))),256))])]),e("div",null,[e("button",{class:"addBtn pl-2 pr-2",onClick:U},"下一步")])])])):f("",!0),n(b)===3?(s(),o("div",tt,[e("div",lt,[e("div",nt,[l[29]||(l[29]=e("div",{class:"w-[120px]"},[e("span",null,"回合累積能量:")],-1)),e("input",{type:"number",id:"pointGet",class:"inputNum",min:1,max:8,required:"",onChange:l[13]||(l[13]=i=>n(a).PointGet=i.target.value)},null,32)]),e("div",st,[l[30]||(l[30]=e("div",{class:"w-[120px]"},[e("span",null,"總儲存能量:")],-1)),e("input",{type:"number",id:"pointMax",class:"inputNum",min:1,max:8,required:"",onChange:l[14]||(l[14]=i=>n(a).PointMax=i.target.value)},null,32)]),e("div",at,[l[31]||(l[31]=e("div",{class:"w-[120px]"},[e("span",null,"回合消耗能量:")],-1)),e("input",{type:"number",id:"pointConsume",class:"inputNum",min:1,max:8,required:"",onChange:l[15]||(l[15]=i=>n(a).PointConsume=i.target.value)},null,32)]),e("div",ot,[l[32]||(l[32]=e("div",{class:"w-[120px]"},[e("span",null,"進場能量:")],-1)),e("input",{type:"number",id:"pointEnter",class:"inputNum",min:1,max:8,required:"",onChange:l[16]||(l[16]=i=>n(a).PointEnter=i.target.value)},null,32)])]),e("div",it,[e("div",dt,[l[33]||(l[33]=e("span",null,"卡片關鍵字:",-1)),e("input",{type:"text",class:"selfInput",placeholder:"輸入完成後按Enter",onKeydown:q},null,32),(s(!0),o(h,null,y(n(a).keyword,i=>(s(),o("span",null,g(i),1))),256))]),e("div",ut,[l[34]||(l[34]=e("span",null,"盤面圖:",-1)),e("button",{onClick:l[17]||(l[17]=i=>J("spreadInput")),class:"max-w-[100px] addBtn px-2"},"上傳"),e("input",{type:"file",id:"spreadInput",class:"hidden",accept:"image/jpeg, image/png, image/jpg",onChange:l[18]||(l[18]=()=>M("spreadInput"))},null,32),e("div",rt,[n(C)!==null?(s(),o("img",{key:0,src:n(C).file,alt:"盤面圖",class:"w-[240px]"},null,8,ct)):f("",!0)])]),l[35]||(l[35]=e("div",{class:"my-2"},[e("span",null,"圖片標示位置:"),e("input",{type:"number",class:"selfInput",id:"spreadIndex",min:1})],-1)),e("div",{class:"mt-2"},[e("button",{class:"addBtn pl-2 pr-2",onClick:U},"下一步")])])])):f("",!0),n(b)===4||n(b)===5?(s(),o("div",ft,[e("div",pt,[e("div",mt,[e("div",vt,[n(a).rarity===1?(s(),o("span",xt,g(n(a).name),1)):f("",!0),n(a).rarity===2?(s(),o("span",gt,g(n(a).name),1)):f("",!0),n(a).rarity===3?(s(),o("span",wt,g(n(a).name),1)):f("",!0)]),n(a).rarity===1?(s(),o("div",bt,[e("img",{src:n(w).file,alt:n(a).name,class:"h-[40vh] min-w-[150px]"},null,8,ht)])):f("",!0),n(a).rarity===2?(s(),o("div",yt,[e("img",{src:n(w).file,alt:n(a).name,class:"h-[40vh] min-w-[150px]"},null,8,_t)])):f("",!0),n(a).rarity===3?(s(),o("div",kt,[e("img",{src:n(w).file,alt:n(a).name,class:"h-[40vh] min-w-[150px]"},null,8,$t)])):f("",!0)]),e("div",Et,[e("div",Ct,[e("div",It,[n(a).rarity===1?(s(),o("div",Bt,l[36]||(l[36]=[e("span",null,"即時效果",-1)]))):f("",!0),n(a).rarity===2?(s(),o("div",St,l[37]||(l[37]=[e("span",null,"即時效果",-1)]))):f("",!0),n(a).rarity===3?(s(),o("div",Nt,l[38]||(l[38]=[e("span",null,"即時效果",-1)]))):f("",!0)]),e("div",jt,[(s(!0),o(h,null,y(n(a).instantEffect,i=>(s(),o("span",Dt,"•"+g(i),1))),256))])]),e("div",Pt,[n(a).rarity===1?(s(),o("div",Ft,l[39]||(l[39]=[e("span",null,"回合效果",-1)]))):f("",!0),n(a).rarity===2?(s(),o("div",Lt,l[40]||(l[40]=[e("span",null,"回合效果",-1)]))):f("",!0),n(a).rarity===3?(s(),o("div",Tt,l[41]||(l[41]=[e("span",null,"回合效果",-1)]))):f("",!0),e("div",Kt,[(s(!0),o(h,null,y(n(a).roundEffect,i=>(s(),o("span",Ot,"•"+g(i),1))),256))])]),e("div",Jt,[n(a).rarity===1?(s(),o("div",Mt,l[42]||(l[42]=[e("span",null,"連動效果",-1)]))):f("",!0),n(a).rarity===2?(s(),o("div",Ut,l[43]||(l[43]=[e("span",null,"連動效果",-1)]))):f("",!0),n(a).rarity===3?(s(),o("div",Vt,l[44]||(l[44]=[e("span",null,"連動效果",-1)]))):f("",!0),e("div",At,[(s(!0),o(h,null,y(n(a).comboEffect,i=>(s(),o("span",qt,"•"+g(i),1))),256))])])])]),e("div",{class:"w-5/6 mt-5 mx-auto"},[e("button",{class:"addBtn min-w-[100px] ml-2",onClick:U},"儲存")])])):f("",!0)]),_:1})]))}},Rt=ue(Gt,[["__scopeId","data-v-15837803"]]),Ht={class:"main"},zt={class:"w-4/5 mx-auto mb-2"},Qt={class:"flex flex-row"},Wt={class:"w-4/5 mx-auto flex flex-row justify-evenly"},Xt={key:0,class:"w-1/2 min-h-[500px] flex flex-row"},Yt={class:"CardImage w-1/2"},Zt={class:"text-white font-bold text-xl"},el=["src"],tl={class:"Details flex flex-col w-1/2 mt-5 [&>div]:mb-5"},ll={class:"flex flex-row"},nl={class:"mb-3 flex flex-col"},sl=["onKeydown"],al={class:"flex flex-row"},ol={class:"mb-3 flex flex-col"},il=["onKeydown"],dl={class:"flex flex-row"},ul={class:"mb-3 flex flex-col"},rl=["onKeydown"],cl={class:"flex flex-col"},fl=["onClick"],pl=["src"],ml={key:0,class:"text-red-500 text-md"},vl={key:1,class:"text-white text-md"},xl={key:1,class:"w-2/5 pl-3 right mt-5 h-[500px] relative"},gl={key:2,class:"w-2/5 pl-3 right mt-5 h-[500px] relative"},wl={class:"flex-col"},bl={class:"mb-3"},hl=["value"],yl={key:0},_l={class:"colorSelect w-[150px]",id:"tagSelect"},kl=["label"],$l=["value"],El={key:1},Cl={class:"mb-2 flex-col"},Il={class:"overflow-y-scroll hiddenScrollbar"},Bl={class:"flex flex-col"},Sl={class:"flex flex-row my-1"},Nl={class:"w-1/5"},jl={class:"text-white"},Dl={class:"w-2/5"},Pl={class:"text-white"},Fl={class:"w-2/5"},Ll=["id","onClick"],Tl={key:3,class:"w-2/5 pl-3 right mt-5 h-[500px] relative"},Kl={key:4,class:"w-2/5 pl-3 right mt-5 h-[500px] relative"},Ol={class:"my-5"},Jl={class:"flex flex-row"},Ml={class:"mb-3 flex flex-col"},Ul=["onKeydown"],Vl={class:"my-5"},Al={class:"flex flex-row my-1"},ql={class:"mb-3 flex flex-col"},Gl=["onKeydown"],Rl={class:"my-5"},Hl={class:"flex flex-row my-1"},zl={class:"mb-3 flex flex-col"},Ql=["onKeydown"],Wl={key:5,class:"w-2/5 pl-3 right mt-5 h-[500px] relative"},Xl={class:"w-3/5 mx-auto my-3"},Yl={class:"slide w-4/5 mx-auto mt-3 pt-3"},Zl={class:"ml-5 mb-3"},en={class:"flex flex-row"},tn=["onClick"],ln=["src"],nn={key:0,class:"w-[100%] text-center bg-amber-900 text-white rounded-md"},sn={key:1,class:"w-[100%] text-center bg-slate-500 text-white rounded-md"},an={key:2,class:"w-[100%] text-center bg-yellow-600 text-white rounded-md"},on={class:"overlay",id:"overlay"},dn={class:"popup max-[500px]:w-[80%] max-[500px]:min-w-[200px]"};let fe=k(null);const un={name:"App",components:{Carousel:ce,Slide:re,Pagination:Ee,Navigation:$e},methods:{slideItem:function(L,N){if(L.target.value>N||L.target.value<0)alert("該編號卡片資料沒有找到!!");else{let P=L.target.value;fe.value.data.slideTo(P-1)}}},data(){}},rn=Object.assign(un,{setup(L){let N=[],P=[],K=k(1),a=k([]),b=k([]),m=k([]),w=k(1),C="",F=k(null),v=k({}),I=k([{name:"基本資訊",mode:"edit_basic"},{name:"效果敘述",mode:"edit_description"},{name:"技能標籤",mode:"edit_tag"},{name:"關鍵字",mode:"edit_keyword"},{name:"圖片管理",mode:"edit_img"},{name:"刪除卡片",mode:"delete"}]),E=k("edit_basic");const B=we("frontpath",""),O=k(B);function J(){T.post("http://localhost:5000/card/get",{get:K.value}).then(u=>{if(console.log(u.data),N=u.data.card,P=u.data.func,u.data=="發生錯誤"){console.log("沒有發現相關資料");return}b.value=JSON.parse(JSON.stringify(P)),m.value=JSON.parse(JSON.stringify(N)),q(1)}).catch(u=>{alert("伺服器尚未開啟請稍後再試!!"),window.location=window.location.origin+"/TestNuxtPage/"})}function M(u){let t=document.getElementById("series"+u);t.classList.contains("clicked")?t.classList.remove("clicked"):t.classList.add("clicked"),K.value=parseInt(u),J()}function V(u){a.value=a.value.filter((r,c)=>c!==u);let t=m.value.find(r=>r.id===parseInt(w.value)).tag;m.value.find(r=>r.id===parseInt(w.value)).tag=t.filter((r,c)=>c!==u),console.log(m.value.find(r=>r.id===parseInt(w.value)))}function A(){var u=parseInt(document.getElementById("tagSelect").value),t={};b.value.forEach(r=>{let c=r.data.find(_=>_.id===u);c!==void 0&&(t=c)}),!(a.value.includes(t)||u===0)&&(a.value.push(t),a.value=a.value.sort((r,c)=>r.id-c.id),m.value.find(r=>r.id===w.value).tag.push(u),m.value.find(r=>r.id===w.value).tag=m.value.find(r=>r.id===w.value).tag.sort((r,c)=>r-c),console.log(N.find(r=>r.id===w.value).tag),console.log(m.value.find(r=>r.id===w.value).tag))}function z(){if(confirm("將會儲存你所做的所有更改，如果確定覆蓋則按確定"))try{let u={getId:K.value,newData:m.value};console.log(u),T.post("http://localhost:5000/card/edit",u).then(t=>{console.log(t),alert(t.data),N=JSON.parse(JSON.stringify(m.value))})}catch(u){console.log(u)}}function q(u){w.value=u,v.value=m.value.find(t=>t.id===w.value),a.value=[],v.value.tag.forEach(t=>{P.forEach(r=>{let c=r.data.find(_=>_.id===t);c!==void 0&&a.value.push(c)})})}function U(){let u={series:K.value,id:w.value};T.post("http://localhost:5000/card/delete",u).then(t=>{console.log(t),m.value=m.value.filter(r=>r.id!==w.value),console.log(m.value),N=JSON.parse(JSON.stringify(m.value)),q(m.value[0].id),alert("卡片刪除成功!")})}function Q(u){if(C=u.target.value,console.log(C),C===""){b.value=P;return}let t=[];P.forEach(r=>{let c=[];if(r.data.forEach(_=>{_.name.includes(C)&&c.push(_)}),c.length!==0){console.log(c);let _=r;_.data=c,t.push(_)}}),t.length!==0?b.value=t:b.value=[]}function W(){let u=N.find(r=>r.id===w.value);if(u==null)return;let t=JSON.parse(JSON.stringify(u));a.value=[],t.tag.forEach(r=>{P.forEach(c=>{let _=c.data.find(R=>R.id===r);_!==void 0&&a.value.push(_)})}),v.value=t,Object.assign(u,t)}function p(u){u.target.parentElement.querySelector("textarea").classList.remove("hidden"),u.target.classList.add("hidden")}function l(u,t,r=void 0){if(console.log(u.key),u.key==="Enter"){switch(t){case"instant":m.value[w.value-1].instantEffect[r]=u.target.value;break;case"round":m.value[w.value-1].roundEffect[r]=u.target.value;break;case"combo":m.value[w.value-1].comboEffect[r]=u.target.value;break}console.log(m.value.find(_=>_.id===w.value)),u.target.parentElement.querySelector("span").classList.remove("hidden"),u.target.classList.add("hidden");return}if(u.key,u.key==="Delete")switch(t){case"instant":break;case"round":m.value.find(c=>c.id===w.value).roundEffect=m.value.find(c=>c.id===w.value).roundEffect.filter((c,_)=>_!==r);break;case"combo":m.value.find(c=>c.id===w.value).comboEffect=m.value.find(c=>c.id===w.value).comboEffect.filter((c,_)=>_!==r);break}}function i(u){let t=m.value.find(r=>r.id===w.value);switch(u){case"round":t.roundEffect.push("回合效果");break;case"instant":t.instantEffect.push("即時效果");break;case"combo":t.comboEffect.push("連動效果");break}}function x(u){let t=m.value.find(r=>r.id===w.value);switch(u){case"round":if(t.roundEffect.length===1)break;t.roundEffect=t.roundEffect.filter((r,c)=>c!==t.roundEffect.length-1);break;case"instant":if(t.instantEffect.length===1)break;t.instantEffect=t.instantEffect.filter((r,c)=>c!==t.instantEffect.length-1);break;case"combo":if(t.comboEffect.length===1)break;t.comboEffect=t.comboEffect.filter((r,c)=>c!==t.comboEffect.length-1);break}}function j(){document.getElementById("overlay").style.display="block",F.value.setFunc(b.value)}function D(){document.getElementById("overlay").style.display="none"}function pe(u){E.value=u}function me(u){N=u,m.value=JSON.parse(JSON.stringify(N))}return xe(v,(u,t)=>{m.value[u.id-1]=u},{deep:!0}),he("close",D),ge(()=>{J()}),(u,t)=>{var r,c,_,R,Z,ee,te,le,ne,se,ae,oe,ie;return s(),o("div",Ht,[e("div",zt,[t[22]||(t[22]=e("span",{class:"text-white text-xl"},"系列",-1)),e("div",Qt,[e("button",{class:"addBtn mr-5 w-[100px]",onClick:t[0]||(t[0]=d=>M(1)),id:"series1"},"晨曦塔"),e("button",{class:"addBtn mr-5 w-[100px]",onClick:t[1]||(t[1]=d=>M(2)),id:"series2"},"測試塔")])]),e("div",Wt,[n(v)!==void 0?(s(),o("div",Xt,[e("div",Yt,[e("span",Zt,g(n(v).name),1),e("img",{src:O.value+n(v).fullimage,alt:"全身圖",class:"max-h-[500px]"},null,8,el)]),H(e("div",tl,[e("div",null,[e("div",ll,[t[23]||(t[23]=e("span",{class:"standwardLabel"},"即時效果",-1)),e("button",{class:"addBtn ml-5",onClick:t[2]||(t[2]=d=>i("instant"))},"新增"),((c=(r=n(v))==null?void 0:r.instantEffect)==null?void 0:c.length)>1?(s(),o("button",{key:0,class:"addBtn ml-5",onClick:t[3]||(t[3]=d=>x("instant"))},"刪除")):f("",!0)]),(s(!0),o(h,null,y(n(v).instantEffect,(d,$)=>(s(),o("div",nl,[e("span",{class:"text-white font-bold",onDblclick:p},g(d),33),e("textarea",{class:"hidden bg-gray-600 text-white h-auto rounded-sm min-h-[50px]",onKeydown:S=>l(S,"instant",$)},g(d),41,sl)]))),256))]),e("div",null,[e("div",al,[t[24]||(t[24]=e("span",{class:"standwardLabel"},"回合效果",-1)),e("button",{class:"addBtn ml-5",onClick:t[4]||(t[4]=d=>i("round"))},"新增"),((R=(_=n(v))==null?void 0:_.roundEffect)==null?void 0:R.length)>1?(s(),o("button",{key:0,class:"addBtn ml-5",onClick:t[5]||(t[5]=d=>x("round"))},"刪除")):f("",!0)]),(s(!0),o(h,null,y(n(v).roundEffect,(d,$)=>(s(),o("div",ol,[e("span",{class:"text-white font-bold",onDblclick:p},g(d),33),e("textarea",{class:"hidden bg-gray-600 text-white h-auto rounded-sm min-h-[50px]",onKeydown:S=>l(S,"round",$)},g(d),41,il)]))),256))]),e("div",null,[e("div",dl,[t[25]||(t[25]=e("span",{class:"standwardLabel"},"連動效果",-1)),e("button",{class:"addBtn ml-5",onClick:t[6]||(t[6]=d=>i("combo"))},"新增"),((ee=(Z=n(v))==null?void 0:Z.comboEffect)==null?void 0:ee.length)>1?(s(),o("button",{key:0,class:"addBtn ml-5",onClick:t[7]||(t[7]=d=>x("combo"))},"刪除")):f("",!0)]),(s(!0),o(h,null,y(n(v).comboEffect,(d,$)=>(s(),o("div",ul,[e("span",{class:"text-white font-bold",onDblclick:p},g(d),33),e("textarea",{class:"hidden bg-gray-600 text-white h-auto rounded-sm min-h-[50px]",onKeydown:S=>l(S,"combo",$)},g(d),41,rl)]))),256))])],512),[[ye,!1]]),e("div",null,[t[26]||(t[26]=e("span",{class:"text-red-700 text-lg"},"選擇要編輯的項目:",-1)),e("div",cl,[(s(!0),o(h,null,y(n(I),d=>(s(),o("div",{class:"my-2 flex flex-row cursor-pointer",onClick:$=>pe(d.mode)},[e("img",{src:O.value+"/images/arrow_right.png",width:"20",height:"20"},null,8,pl),d.mode==="delete"?(s(),o("span",ml,g(d.name),1)):(s(),o("span",vl,g(d.name),1))],8,fl))),256))])])])):f("",!0),n(E)=="edit_basic"?(s(),o("div",xl,[G(_e,{card:n(v),"onUpdate:card":t[8]||(t[8]=d=>de(v)?v.value=d:v=d)},null,8,["card"])])):f("",!0),n(E)=="edit_tag"?(s(),o("div",gl,[e("div",wl,[t[29]||(t[29]=e("span",{class:"standwardLabel"},"自身技能標籤",-1)),e("div",bl,[e("input",{type:"text",value:n(C),placeholder:"技能關鍵字",onInput:t[9]||(t[9]=d=>Q(d)),class:"colorSelect"},null,40,hl)]),((te=n(b))==null?void 0:te.length)!==0?(s(),o("div",yl,[e("select",_l,[t[27]||(t[27]=e("option",{value:0},g("請選擇"),-1)),(s(!0),o(h,null,y(n(b),d=>(s(),o("optgroup",{label:d.typeName},[(s(!0),o(h,null,y(d.data,$=>(s(),o("option",{value:$.id,class:"bg-amber-900"},g($.name),9,$l))),256))],8,kl))),256))]),e("button",{class:"rounded-sm bg-gray-600 min-w-[50px] text-white",onClick:t[10]||(t[10]=d=>A())},"新增")])):(s(),o("div",El,t[28]||(t[28]=[e("span",{class:"text-yellow-500 font-bold text-lg"},"沒有找到匹配技能標籤",-1)])))]),e("div",Cl,[e("div",Il,[e("div",Bl,[(s(!0),o(h,null,y(n(a),(d,$)=>(s(),o("div",Sl,[e("div",Nl,[e("span",jl,g(d.id),1)]),e("div",Dl,[e("span",Pl,g(d.name),1)]),e("div",Fl,[e("button",{class:"removeBtn",id:"btns"+$,onClick:S=>V($)},"移除",8,Ll)])]))),256))])])])])):f("",!0),n(E)=="edit_keyword"?(s(),o("div",Tl,[G(ke,{card:n(v),"onUpdate:card":t[11]||(t[11]=d=>de(v)?v.value=d:v=d)},null,8,["card"])])):f("",!0),n(E)=="edit_description"?(s(),o("div",Kl,[t[33]||(t[33]=e("div",null,[e("span",{class:"text-amber-800 text-[18px]"},"效果敘述")],-1)),e("div",Ol,[e("div",Jl,[t[30]||(t[30]=e("span",{class:"standwardSubLabel"},"即時效果",-1)),e("button",{class:"addBtn ml-5",onClick:t[12]||(t[12]=d=>i("instant"))},"新增"),((ne=(le=n(v))==null?void 0:le.instantEffect)==null?void 0:ne.length)>1?(s(),o("button",{key:0,class:"addBtn ml-5",onClick:t[13]||(t[13]=d=>x("instant"))},"刪除")):f("",!0)]),(s(!0),o(h,null,y(n(v).instantEffect,(d,$)=>(s(),o("div",Ml,[e("span",{class:"text-white font-bold",onDblclick:p},g(d),33),e("textarea",{class:"hidden bg-gray-600 text-white h-auto rounded-sm min-h-[50px]",onKeydown:S=>l(S,"instant",$)},g(d),41,Ul)]))),256))]),e("div",Vl,[e("div",Al,[t[31]||(t[31]=e("span",{class:"standwardSubLabel"},"回合效果",-1)),e("button",{class:"addBtn ml-5",onClick:t[14]||(t[14]=d=>i("round"))},"新增"),((ae=(se=n(v))==null?void 0:se.roundEffect)==null?void 0:ae.length)>1?(s(),o("button",{key:0,class:"addBtn ml-5",onClick:t[15]||(t[15]=d=>x("round"))},"刪除")):f("",!0)]),(s(!0),o(h,null,y(n(v).roundEffect,(d,$)=>(s(),o("div",ql,[e("span",{class:"text-white font-bold",onDblclick:p},g(d),33),e("textarea",{class:"hidden bg-gray-600 text-white h-auto rounded-sm min-h-[50px]",onKeydown:S=>l(S,"round",$)},g(d),41,Gl)]))),256))]),e("div",Rl,[e("div",Hl,[t[32]||(t[32]=e("span",{class:"standwardSubLabel"},"連動效果",-1)),e("button",{class:"addBtn ml-5",onClick:t[16]||(t[16]=d=>i("combo"))},"新增"),((ie=(oe=n(v))==null?void 0:oe.comboEffect)==null?void 0:ie.length)>1?(s(),o("button",{key:0,class:"addBtn ml-5",onClick:t[17]||(t[17]=d=>x("combo"))},"刪除")):f("",!0)]),(s(!0),o(h,null,y(n(v).comboEffect,(d,$)=>(s(),o("div",zl,[e("span",{class:"text-white font-bold",onDblclick:p},g(d),33),e("textarea",{class:"hidden bg-gray-600 text-white h-auto rounded-sm min-h-[50px]",onKeydown:S=>l(S,"combo",$)},g(d),41,Ql)]))),256))])])):f("",!0),n(E)=="delete"?(s(),o("div",Wl,[t[35]||(t[35]=e("div",null,[e("span",{class:"text-amber-800 text-[18px]"},"刪除卡片")],-1)),e("div",{class:"flex flex-col mt-2 justify-start"},[t[34]||(t[34]=e("span",{class:"text-white"},"經過此操作後，該筆資料將永久刪除，按下下面按鈕以確認操作",-1)),e("button",{class:"removeBtn w-[100px]",onClick:U},"確認刪除")])])):f("",!0)]),e("div",Xl,[e("button",{class:"removeBtn min-w-[150px] mb-3",onClick:t[18]||(t[18]=d=>z())},"儲存"),e("button",{class:"removeBtn min-w-[150px] mb-3",onClick:t[19]||(t[19]=d=>W())},"還原")]),e("div",Yl,[e("div",Zl,[t[36]||(t[36]=e("span",{class:"text-white"},"請輸入要卡片編號:",-1)),e("div",en,[e("input",{type:"number",class:"w-[100px] rounded-md text-center",onChange:t[20]||(t[20]=d=>u.slideItem(d,n(m).length))},null,32),e("button",{class:"addBtn ml-3 px-3",onClick:t[21]||(t[21]=()=>j())},"添加卡片")])]),G(n(ce),{"wrap-around":!0,"items-to-show":5,ref_key:"cardSlide",ref:fe},{default:Y(()=>[(s(!0),o(h,null,y(n(m),(d,$)=>(s(),be(n(re),{key:$},{default:Y(()=>[e("div",{class:"flex-col [&>span]:block cursor-pointer",onClick:S=>q(d.id)},[e("img",{src:O.value+d.image,width:"160",alt:"not found"},null,8,ln),d.rarity===1?(s(),o("span",nn,g(d.id),1)):f("",!0),d.rarity===2?(s(),o("span",sn,g(d.id),1)):f("",!0),d.rarity===3?(s(),o("span",an,g(d.id),1)):f("",!0)],8,tn)]),_:2},1024))),128))]),_:1},512)]),e("div",on,[e("div",dn,[e("div",{class:"close",onClick:D},"✖"),G(Rt,{ref_key:"popup",ref:F,max:n(m).length+1,func:n(b),onClose:D,onUpdateCard:me},null,8,["max","func"])])])])}}}),xn=ue(rn,[["__scopeId","data-v-ab2b3857"]]);export{xn as default};
